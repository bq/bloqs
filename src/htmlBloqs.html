<!DOCTYPE html>
<html>

<head>
    <title>bloqs demo</title>
    <style type="text/css">
    html {
        width: 100%;
        height: 100%;
    }
    
    #field,
    .bloqs--container {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
    }
    
    .bloq {
        margin: 1px;
        display: block;
        position: absolute;
    }
    
    .statementBloq {
        width: 100px;
        height: 100px;
        background-color: #0FF;
    }
    
    .bloq2 {
        width: 100px;
        height: 100px;
        background-color: #000;
    }
    
    .forBloq {
        width: 100px;
        min-height: 100px;
        overflow: hidden;
        border-top: 5px solid #000;
        border-left: 5px solid #000;
        border-bottom: 5px solid #000;
    }
    
    .varBloq {
        width: 100px;
        height: 50px;
        background-color: #FF0;
    }
    
    .drop-active {
        background-color: #005;
    }
    
    .can-drop {
        background-color: #555;
    }
    
    .forBloq .bloq {
        position: static;
        float: left;
    }
    </style>
</head>

<body>
    <div class="bloqs--container">
        <div id="field" class="bloqs--main"></div>
        <button>click</button>
    </div>
    <!--<script src="./../bower_components/jquery/dist/jquery.min.js"></script>
    <script src="./../bower_components/interact/interact.js"></script>
    <script src="./../dist/bloqs2.js"></script>-->
    <script data-main="./../src/start" src="./../bower_components/requirejs/require.js"></script>
    <!--<script type="text/javascript">
    /*function createBloq(bloqClass) {
    var $bloq = $('
    <div>', { class: 'bloq' }); var field = $('#field'); $bloq.addClass(bloqClass); $bloq.click(function() { //console.log(bloqClass); }); interact('.' + bloqClass).draggable({ restrict: { restriction: '#field' }, onmove: dragMoveListener, onstart: function(e) { console.log('dragstart'); if (!$(e.target.parentElement).is(field)) { console.log('mi parent no es field'); var $bloq = $(e.target); var x = $bloq.parent().position().left + $bloq.position().left; var y = $bloq.parent().position().top + $bloq.position().top; field.append(e.target); $bloq.css({ webkitTransform: 'translate(' + x + 'px, ' + y + 'px)', transform: 'translate(' + x + 'px, ' + y + 'px)' }); $bloq.attr('data-x', x); $bloq.attr('data-y', y); } } }); field.append($bloq); switch (bloqClass) { case 'forBloq': interact('.' + bloqClass).dropzone({ ondropactivate: function(event) { // add active dropzone feedback event.target.classList.add('drop-active'); }, ondragenter: function(event) { var draggableElement = event.relatedTarget, dropzoneElement = event.target; // feedback the possibility of a drop dropzoneElement.classList.add('drop-target'); draggableElement.classList.add('can-drop'); draggableElement.textContent = 'Dragged in'; }, ondragleave: function(event) { // remove the drop feedback style event.target.classList.remove('drop-target'); event.relatedTarget.classList.remove('can-drop'); event.relatedTarget.textContent = 'Dragged out'; }, ondrop: function(event) { event.relatedTarget.textContent = 'Dropped'; console.log(event.target); $(event.target).append(event.relatedTarget); event.relatedTarget.style.webkitTransform = event.relatedTarget.style.transform = null; event.relatedTarget.setAttribute('data-x', 0); event.relatedTarget.setAttribute('data-y', 0); }, ondropdeactivate: function(event) { // remove active dropzone feedback event.target.classList.remove('drop-active'); event.target.classList.remove('drop-target'); } }); break; case 'varBloq': break; } } function dragMoveListener(event) { var target = event.target, // keep the dragged position in the data-x/data-y attributes x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx, y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy; // translate the element target.style.webkitTransform = target.style.transform = 'translate(' + x + 'px, ' + y + 'px)'; // update the posiion attributes target.setAttribute('data-x', x); target.setAttribute('data-y', y); } createBloq('forBloq'); createBloq('varBloq'); createBloq('bloq1'); createBloq('bloq');*/


    var statement = {
        type: 'statement',
        connectors: [{
            type: 'connector-top',
            accept: ['connector-bottom']

        }, {
            type: 'connector-bottom',
            accept: ['connector-top']

        }]

    };

    var output = {
        type: 'output',
        connectors: [{
            type: 'connector-output',
            accept: ['connector-input']
        }]
    };

    var setVariableBloq = {
        name: 'setVariable',
        type: 'statement',
        content: [
            [{
                alias: 'stringInput',
                placeholder: 'Introduce el nombre de la variable'
            }, {
                alias: 'text',
                value: '='
            }, {
                alias: 'bloqInput',
                acceptType: 'all'
            }]
        ]
    };

    var number = {
        type: 'output',
        name: 'number',
        content: [{
            alias: 'numberInput',
            placeholder: 'Introduce valor'
        }],
        code: {
            setup: ['{0}'],
            loop: ['{0}']
        }
    };

    function Bloq(params) {
        this.bloqType = params.bloqType;
        this.$bloq = $('<div>');
        this.connectors = [];

        this.$bloq.addClass('bloq');
        this.$bloq.addClass(params.bloqType);


        interact(this.$bloq.get()[0]).draggable({
            restrict: {
                restriction: '#field'
            },
            onmove: function(event) {
                //console.log('move', target);
                var target = event.target,
                    // keep the dragged position in the data-x/data-y attributes
                    x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx,
                    y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy;
                // translate the element
                target.style.webkitTransform =
                    target.style.transform =
                    'translate(' + x + 'px, ' + y + 'px)';

                // update the posiion attributes
                target.setAttribute('data-x', x);
                target.setAttribute('data-y', y);
            },
            onstart: function(e) {
                console.log('dragstart');
                /*if (!$(e.target.parentElement).is(field)) {
                    console.log('mi parent no es field');
                    var $bloq = $(e.target);
                    var x = $bloq.parent().position().left + $bloq.position().left;
                    var y = $bloq.parent().position().top + $bloq.position().top;
                    field.append(e.target);
                    $bloq.css({
                        webkitTransform: 'translate(' + x + 'px, ' + y + 'px)',
                        transform: 'translate(' + x + 'px, ' + y + 'px)'
                    });
                    $bloq.attr('data-x', x);
                    $bloq.attr('data-y', y);
                }*/
            }
        });



        return this.$bloq;
    }
    var $field = $('#field');

    var bloq1 = new Bloq({
        bloqType: 'statementBloq'
    });

    var bloq2 = new Bloq({
        bloqType: 'statementBloq'
    });

    var bloq3 = new Bloq({
        bloqType: 'statementBloq'
    });

    $field.append(bloq1);
    $field.append(bloq2);
    $field.append(bloq3);
    </script>-->
</body>

</html>